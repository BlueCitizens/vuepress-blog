import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as n,d as i}from"./app-UZx5qVko.js";const t={},l=i(`<h1 id="在wsl2上无法启动srs服务" tabindex="-1"><a class="header-anchor" href="#在wsl2上无法启动srs服务"><span>在WSL2上无法启动srs服务</span></a></h1><h2 id="环境" tabindex="-1"><a class="header-anchor" href="#环境"><span>环境</span></a></h2><p>WSL2 Ubuntu 20.04 LTS</p><h2 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h2><p>通过./objs/srs -c conf/srs.conf启动SRS服务。控制台没有报异常，正常输出了以下几行：</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>bluecitizen@DESKTOP-A2E34TM:~/srs/trunk$ ./objs/srs -c conf/srs.conf

[2021-04-01 12:30:17.996][Trace][7308][0] XCORE-SRS/3.0.158(OuXuli)
[2021-04-01 12:30:17.997][Trace][7308][0] config parse complete
[2021-04-01 12:30:17.998][Trace][7308][0] you can check log by: tail -f ./objs/srs.log (@see https://github.com/ossrs/srs/wiki/v1_CN_SrsLog)
[2021-04-01 12:30:17.998][Trace][7308][0] please check SRS by: ./etc/init.d/srs status
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后启动ffmpeg推流，报错1935端口拒绝连接</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>bluecitizen@DESKTOP-A2E34TM:/mnt/d/dld$ ffmpeg -re -i rika-police.mp4 -c copy -f flv rtmp://172.17.162.184:1935/live/livestream

[tcp @ 0x557523daad00] Connection to tcp://172.17.162.184:1935 failed: Connection refused
[rtmp @ 0x557523daa340] Cannot open connection tcp://172.17.162.184:1935
rtmp://172.17.162.184:1935/live/livestream: Connection refused
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一脸懵逼的我习惯性百度了一圈，没有找到合理的解释。</p><p>于是乎只能自己动手检查，先telnet一下端口：</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>bluecitizen@DESKTOP-A2E34TM:/mnt/d/dld$ telnet localhost 1935

Trying 127.0.0.1...
telnet: Unable to connect to remote host: Connection refused
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这里用了回环地址，因为WSL是可以用回环地址的（虚拟机和本机共享）。但WSL的回环地址总有各种bug，于是查找进程：</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>bluecitizen@DESKTOP-A2E34TM:/mnt/d/dld$ ps aux|grep srs

bluecit+  7272  0.0  0.0   8160   728 pts/1    S+   11:31   0:00 grep --color=auto srs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>进一步查询srs的pid文件，发现是failed，于是又重新启动一次，依然输出了正常的启动信息，但进程信息无效。</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>bluecitizen@DESKTOP-A2E34TM:~/srs/trunk$ ./etc/init.d/srs status
Error: No pid file /home/bluecitizen/srs/trunk/objs/srs.pid[FAILED]
bluecitizen@DESKTOP-A2E34TM:~/srs/trunk$ ./objs/srs -c conf/srs.conf
[2021-04-01 12:30:17.996][Trace][7308][0] XCORE-SRS/3.0.158(OuXuli)
[2021-04-01 12:30:17.997][Trace][7308][0] config parse complete
[2021-04-01 12:30:17.998][Trace][7308][0] you can check log by: tail -f ./objs/srs.log (@see https://github.com/ossrs/srs/wiki/v1_CN_SrsLog)
[2021-04-01 12:30:17.998][Trace][7308][0] please check SRS by: ./etc/init.d/srs status
bluecitizen@DESKTOP-A2E34TM:~/srs/trunk$ ./etc/init.d/srs status
Error: No pid file /home/bluecitizen/srs/trunk/objs/srs.pid[FAILED]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不信邪的我又手动进入了相关目录，真的没有。</p><p>随便尝试进入root用户启动，居然成功了，推流也恢复正常：</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>root@DESKTOP-A2E34TM:/home/bluecitizen/srs/trunk/objs/nginx# cd ..
root@DESKTOP-A2E34TM:/home/bluecitizen/srs/trunk/objs# cd ..
root@DESKTOP-A2E34TM:/home/bluecitizen/srs/trunk# ./objs/srs -c conf/srs.conf
[2021-04-01 12:36:49.131][Trace][7376][0] XCORE-SRS/3.0.158(OuXuli)
[2021-04-01 12:36:49.131][Trace][7376][0] config parse complete
[2021-04-01 12:36:49.131][Trace][7376][0] you can check log by: tail -f ./objs/srs.log (@see https://github.com/ossrs/srs/wiki/v1_CN_SrsLog)
[2021-04-01 12:36:49.132][Trace][7376][0] please check SRS by: ./etc/init.d/srs status
root@DESKTOP-A2E34TM:/home/bluecitizen/srs/trunk# ./etc/init.d/srs status
SRS(pid 7378) is running.                                  [  OK  ]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也看到了熟悉的进程：</p><div class="language-Shell line-numbers-mode" data-ext="Shell" data-title="Shell"><pre class="language-Shell"><code>root@DESKTOP-A2E34TM:/mnt/d/dld# ps aux|grep srs
root      7378  0.1  0.2  25104 18936 pts/1    S    12:36   0:13 ./objs/srs -c conf/srs.conf
root      7397  0.0  0.0   8160   732 pts/1    S+   15:07   0:00 grep --color=auto srs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>在服务器的Ubuntu 20.04 LTS上，即便没有使用root用户也可以正常启动。排除部署过程的差别，很有可能还是WSL本身的问题。。。第一次用WSL作为生产力折腾就出问题，很难让人放心用下去啊。。。</p><h2 id="quote" tabindex="-1"><a class="header-anchor" href="#quote"><span>Quote</span></a></h2><p>https://ask.csdn.net/questions/4077478</p>`,24),r=[l];function a(c,d){return s(),n("div",null,r)}const p=e(t,[["render",a],["__file","在WSL2上无法启动SRS服务.html.vue"]]),m=JSON.parse(`{"path":"/posts/%E5%9C%A8WSL2%E4%B8%8A%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8SRS%E6%9C%8D%E5%8A%A1.html","title":"在WSL2上无法启动srs服务","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2021-03-17T00:00:00.000Z","category":["运维"],"tag":["流媒体","SRS"],"description":"在WSL2上无法启动srs服务 环境 WSL2 Ubuntu 20.04 LTS 问题 通过./objs/srs -c conf/srs.conf启动SRS服务。控制台没有报异常，正常输出了以下几行： 然后启动ffmpeg推流，报错1935端口拒绝连接 一脸懵逼的我习惯性百度了一圈，没有找到合理的解释。 于是乎只能自己动手检查，先telnet一下端口：...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/posts/%E5%9C%A8WSL2%E4%B8%8A%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8SRS%E6%9C%8D%E5%8A%A1.html"}],["meta",{"property":"og:site_name","content":"BCkun's BLOG"}],["meta",{"property":"og:title","content":"在WSL2上无法启动srs服务"}],["meta",{"property":"og:description","content":"在WSL2上无法启动srs服务 环境 WSL2 Ubuntu 20.04 LTS 问题 通过./objs/srs -c conf/srs.conf启动SRS服务。控制台没有报异常，正常输出了以下几行： 然后启动ffmpeg推流，报错1935端口拒绝连接 一脸懵逼的我习惯性百度了一圈，没有找到合理的解释。 于是乎只能自己动手检查，先telnet一下端口：..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-27T02:44:22.000Z"}],["meta",{"property":"article:author","content":"BlueCitizen"}],["meta",{"property":"article:tag","content":"流媒体"}],["meta",{"property":"article:tag","content":"SRS"}],["meta",{"property":"article:published_time","content":"2021-03-17T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-27T02:44:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在WSL2上无法启动srs服务\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-03-17T00:00:00.000Z\\",\\"dateModified\\":\\"2024-02-27T02:44:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"BlueCitizen\\",\\"url\\":\\"https://bckun.top\\"}]}"]]},"headers":[{"level":2,"title":"环境","slug":"环境","link":"#环境","children":[]},{"level":2,"title":"问题","slug":"问题","link":"#问题","children":[]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]},{"level":2,"title":"Quote","slug":"quote","link":"#quote","children":[]}],"git":{"createdTime":1709001862000,"updatedTime":1709001862000,"contributors":[{"name":"BlueCitizens","email":"bluecitizens@163.com","commits":1}]},"readingTime":{"minutes":2.33,"words":698},"filePathRelative":"posts/在WSL2上无法启动SRS服务.md","localizedDate":"2021年3月17日","excerpt":"\\n<h2>环境</h2>\\n<p>WSL2 Ubuntu 20.04 LTS</p>\\n<h2>问题</h2>\\n<p>通过./objs/srs -c conf/srs.conf启动SRS服务。控制台没有报异常，正常输出了以下几行：</p>\\n<div class=\\"language-Shell\\" data-ext=\\"Shell\\" data-title=\\"Shell\\"><pre class=\\"language-Shell\\"><code>bluecitizen@DESKTOP-A2E34TM:~/srs/trunk$ ./objs/srs -c conf/srs.conf\\n\\n[2021-04-01 12:30:17.996][Trace][7308][0] XCORE-SRS/3.0.158(OuXuli)\\n[2021-04-01 12:30:17.997][Trace][7308][0] config parse complete\\n[2021-04-01 12:30:17.998][Trace][7308][0] you can check log by: tail -f ./objs/srs.log (@see https://github.com/ossrs/srs/wiki/v1_CN_SrsLog)\\n[2021-04-01 12:30:17.998][Trace][7308][0] please check SRS by: ./etc/init.d/srs status\\n</code></pre></div>","autoDesc":true}`);export{p as comp,m as data};
