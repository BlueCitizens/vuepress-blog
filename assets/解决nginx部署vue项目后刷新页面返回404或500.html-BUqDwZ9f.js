import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as t,c as i,e as n}from"./app-_HkpRMbx.js";const r={},s=n(`<h1 id="解决nginx部署vue项目后刷新页面返回404或500" tabindex="-1"><a class="header-anchor" href="#解决nginx部署vue项目后刷新页面返回404或500"><span>解决nginx部署vue项目后刷新页面返回404或500</span></a></h1><p>官方的Router文档中有相关解决方案：https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90</p><p>原因：vue的history模式下，切换路由本质是通过js操作window.history方法来改变浏览器地址栏里的路径，并没有发起http请求。但是当我直接在浏览器里输入这个地址的时候，其实是对服务器发起了http请求，而这个目标（即http请求的资源）在服务器上根本不存在，所以nginx会返回404。同理，500就是路径本身有错误。</p><p>解决原理：在服务端增加一个覆盖所有情况的候选资源。如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是app依赖的页面。</p><p>官方对nginx的解决方法</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>location / {
  try_files $uri $uri/ /index.html;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例如我的nginx.conf</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server {
	listen 80;
	#监听端口
	root /usr/share/nginx/html;
	#静态资源所在目录
	index index.html;
	#默认主页
	charset utf-8;

	location / {#这一段location是新加入的配置
		root /usr/share/nginx/html;
		try_files $uri $uri/ /index.html;
		index index.html;
	}

	location /prod-api/ {
		rewrite  /prod-api/(.*)  /$1  break;
		proxy_pass http://192.168.0.1:8081;
	} 
	#/-资源路径 有uri 访问uri没有就访问index.html
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>VUE的router[mode: history]模式在开发环境下使用的服务器为node，在Dev环境中不会有问题。但在在服务器部署生产环境的nginx中需要自行配置。</em></p>`,9),a=[s];function o(l,d){return t(),i("div",null,a)}const p=e(r,[["render",o],["__file","解决nginx部署vue项目后刷新页面返回404或500.html.vue"]]),m=JSON.parse(`{"path":"/posts/%E8%A7%A3%E5%86%B3nginx%E9%83%A8%E7%BD%B2vue%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%88%B7%E6%96%B0%E9%A1%B5%E9%9D%A2%E8%BF%94%E5%9B%9E404%E6%88%96500.html","title":"解决nginx部署vue项目后刷新页面返回404或500","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2020-06-23T00:00:00.000Z","category":["运维"],"tag":["Nginx","Linux","Vue"],"description":"解决nginx部署vue项目后刷新页面返回404或500 官方的Router文档中有相关解决方案：https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90 原因：vue的his...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/posts/%E8%A7%A3%E5%86%B3nginx%E9%83%A8%E7%BD%B2vue%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%88%B7%E6%96%B0%E9%A1%B5%E9%9D%A2%E8%BF%94%E5%9B%9E404%E6%88%96500.html"}],["meta",{"property":"og:site_name","content":"BCkun's BLOG"}],["meta",{"property":"og:title","content":"解决nginx部署vue项目后刷新页面返回404或500"}],["meta",{"property":"og:description","content":"解决nginx部署vue项目后刷新页面返回404或500 官方的Router文档中有相关解决方案：https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90 原因：vue的his..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-27T02:44:22.000Z"}],["meta",{"property":"article:author","content":"BlueCitizen"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:tag","content":"Linux"}],["meta",{"property":"article:tag","content":"Vue"}],["meta",{"property":"article:published_time","content":"2020-06-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-27T02:44:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"解决nginx部署vue项目后刷新页面返回404或500\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-06-23T00:00:00.000Z\\",\\"dateModified\\":\\"2024-02-27T02:44:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"BlueCitizen\\",\\"url\\":\\"https://bckun.top\\"}]}"]]},"headers":[],"git":{"createdTime":1709001862000,"updatedTime":1709001862000,"contributors":[{"name":"BlueCitizens","email":"bluecitizens@163.com","commits":1}]},"readingTime":{"minutes":1.31,"words":394},"filePathRelative":"posts/解决nginx部署vue项目后刷新页面返回404或500.md","localizedDate":"2020年6月23日","excerpt":"\\n<p>官方的Router文档中有相关解决方案：https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90</p>\\n<p>原因：vue的history模式下，切换路由本质是通过js操作window.history方法来改变浏览器地址栏里的路径，并没有发起http请求。但是当我直接在浏览器里输入这个地址的时候，其实是对服务器发起了http请求，而这个目标（即http请求的资源）在服务器上根本不存在，所以nginx会返回404。同理，500就是路径本身有错误。</p>","autoDesc":true}`);export{p as comp,m as data};
