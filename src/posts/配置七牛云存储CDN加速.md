---
icon: pen-to-square
date: 2020-06-23
category:
  - 运维
---

# 配置七牛云cdn加速

可参考七牛云官方文档《如何配置域名的 CNAME：https://developer.qiniu.com/fusion/kb/1322/how-to-configure-cname-domain-name

## 准备条件

1. 一个已经完成备案状态正常的域名，例如bravo.xyz
2. 七牛云对象存储空间，例如blog-img

（域名和存储空间都是随便举了个例子，后面均以此为例）

## 操作步骤

### 创建加速域名

首先，进入七牛云控制台的域名管理（CDN—>域名管理）。点击创建域名。补全空缺的项目。域名类型根据自己的需求，个人使用的通常都是普通域名，维持默认选项。加速域名为是自定义的二级域名。照抄一个七牛云官方提供的例子，简单易懂：
```
假设您购买的一级域名为 qiniu.com
您需要先在七牛控制台创建加速域名，比如您创建了 cdn.qiniu.com 或 img.qiniu.com 之类的自定义二级域名。
创建完成后，在域名厂商后台添加解析记录时，您需要填写主机记录为加速域名对应的前缀，如 cdn 或 img 即可。
注意：主机记录需要和加速前缀完全一致，请对应填写。
```
简单来说，我们在服务商购买到的域名都是一级域名，如bravo.xyz，但我们自己也可以为一级域名自定义前缀成为二级域名，加速域名就是在一级域名的基础上增加前缀的二级域名。这个前缀称之为**加速前缀**。例如随便写一个 nmsl.bravo.xyz 就可以是一个二级域名。有时为了体现业务，也会赋予这个前缀一些含义，例如图片、视频、文档等。再举一些例子：
```
img.bravo.xyz 图片
video.bravo.xyz 视频
doc.bravo.xyz 文档
```
当然你完全可以继续追加前缀，比如 
```
lg.img.bravo.xyz 大图
video.cdn.bravo.xyz 视频加速
```
等，可以体现更复杂的业务。

通信协议根据具体情况选择。我们使用的基本都是http协议。


![CDN0](https://pic.downk.cc/item/5ef23e4e14195aa59463d590.png)

其他若干选项基本可以维持默认，使用场景根据需求选择。本例中选择图片小文件。源站位置选择目标存储空间，例如blog-img。

![CDN1](https://pic.downk.cc/item/5ef2437c14195aa59466f2b5.png)

也就是说，通常只需要编一个加速域名，再选择自己的使用场景，其他维持默认配置就好了。

创建后，域名管理中会多出刚才配置的加速域名，并显示正在进行相关设置，通常等待几分钟内系统就会自动完成。此时会提示你配置CNAME。

关于CNAME的是什么以及如何配置，移步官方文档即可。此处以阿里云购买的域名为例展示配置过程。

### 配置域名解析

1. 进入阿里云域名控制台，在全部域名中找到相应的一级域名，例如bravo.xyz，点击操作中的解析进入云解析DNS。
2. 点击添加记录，按照图中所示填写：

![CDN2](https://pic.downk.cc/item/5ef2476e14195aa59469a419.png)

其中 CNAME 在加速域名创建时会自动生成一个，当然也是可以在七牛云中自行配置的，具体官方文档中都有。TTL是更新CNAME后的解析生效时间，无特殊需求维持默认就可以。